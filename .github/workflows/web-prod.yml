name: Web App - PROD
on:
    workflow_dispatch:
    workflow_call:

jobs:
  deploy-web-app:
    name: Deploy Web App Prod
    runs-on:
      labels: ubuntu-latest
    steps:
    - name: Load secrets from 1Password
      uses: 1password/load-secrets-action@v2.0.0
      with:
        export-env: true # Export loaded secrets as environment variables
      env:
        OP_SERVICE_ACCOUNT_TOKEN: ${{ secrets.OP_SERVICE_ACCOUNT_TOKEN }}
        SLACK_WEBHOOK_URL: "op://rbiv7rvkkrsdlpcrz3bmv7nmcu/Slack webhook URLs/rdpfgrmnbxqaelgi5oky3lryz4/internal-add-feeds"

    - name: Deploy Web App
      uses: ./.github/workflows/web-app-deployer.yml
      with:
        FIREBASE_PROJECT: prod
        REACT_APP_GOOGLE_ANALYTICS_ID: ${{ vars.PROD_REACT_APP_GOOGLE_ANALYTICS_ID }}
        FEED_SUBMIT_GOOGLE_SHEET_ID: "10eIUxWVtLmc2EATiwivgXBf4bOMErOnq7GFIoRedXHU"
        SLACK_WEBHOOK_URL: ${{ env.SLACK_WEBHOOK_URL }}

